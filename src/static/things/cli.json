{
  "layout": "blog",
  "name": "linux",
  "notes": "## Unix Tools\n\n```\ntar -xzvf (gz compressed)\ntar -xjvf (bz2 compressed)\n```\n\nWhen filesystem is mounted under SMB, even root will have trouble settings correct permissions through the sudo command. **You can get around this problem by specifying ```--no-same-owner```**\n\n```\ntar xzvf stuff.tar.gz --no-same-owner -C /media/dest\n```\n\n### Checking Auth\n```\n> last\nuser      pts/4        108.210.178.151  Sun Jan 26 04:05   still logged in\n...\n\n> vim /var/log/auth.log\nJan 24 03:07:47 hostname sshd[14435]: Invalid user admin from 141.98.81.37 port 42579\n\n```\n\n### Reverse Tunneling\n```\nssh –f –N –T –R 2222:localhost:22 username@everythingcli.org\n```\n - -f: tells the SSH to background itself after it authenticates, saving you time by not having to run something on the remote server for the tunnel to remain alive.\n - -N: if all you need is to create a tunnel without running any remote commands then include this option to save resources.\n - -T: useful to disable pseudo-tty allocation, which is fitting if you are not trying to create an interactive shell.\n```\nautossh -M 0 -o \"ServerAliveInterval 30\" -o \"ServerAliveCountMax 3\"\n```\n - autossh for auto reconnect on intervals\n\n```\nautossh -M 0 -o \"ServerAliveInterval 30\" -o \"ServerAliveCountMax 3\" –f –N –T –R 2222:localhost:22 cytopia@everythingcli.org\n```\n\n### Open RC\n - [https://wiki.gentoo.org/wiki/OpenRC](https://wiki.gentoo.org/wiki/OpenRC)\n - [https://wiki.alpinelinux.org/wiki/Alpine_Linux_Init_System](https://wiki.alpinelinux.org/wiki/Alpine_Linux_Init_System)\n\n```\nrc-update add <service> <runlevel>\nrc-update del <service> <runlevel>\nrc-service <service> <start stop restart>\nrc-status\nrc <runlevel>\n``` \n\n - init scripts in /etc/init.d\n - update-rc.d does not work fine if there is no specific comment block in the start script that looks like this:\n - On Raspbian Buster (v10) #! /bin/sh must appear right before the BEGIN INIT INFO block.\n```\n#!/sbin/openrc-run\n\n### BEGIN INIT INFO\n# Provides: myprogram\n# Required-Start: $ local_fs $ remote_fs $ syslog $ network $ time\n# Required-Stop: $ local_fs $ remote_fs $ syslog $ network\n# Default-start: 2 3 4 5\n# Default-Stop: 0 1 6\n# Short-Description: myprogram some description\n### END INIT INFO\n\nstart() {\n        echo -n \"Starting : \"\n\n        touch /var/lock/subsys/\n        return\n}\n\nstop() {\n        echo -n \"Shutting down : \"\n\n        rm -f /var/lock/subsys/\n        return\n}\n\ncase \"$1\" in\n    start)\n        start\n        ;;\n    stop)\n        stop\n        ;;\n    status)\n\n        ;;\n    restart)\n        stop\n        start\n        ;; \n    *)\n        echo \"Usage:  {start|stop|status|reload|restart[|probe]\"\n        exit 1\n        ;;\nesac\n```\n\n##### References\n - [https://www.linux.com/tutorials/managing-linux-daemons-init-scripts/](https://www.linux.com/tutorials/managing-linux-daemons-init-scripts/)\n - [https://www.everythingcli.org/ssh-tunnelling-for-fun-and-profit-autossh/](https://www.everythingcli.org/ssh-tunnelling-for-fun-and-profit-autossh/)\n - [https://askubuntu.com/questions/936728/how-to-keep-ssh-connection-alive](https://askubuntu.com/questions/936728/how-to-keep-ssh-connection-alive)\n - [https://unix.stackexchange.com/questions/102918/service-to-start-on-boot-doesnt-work-with-update-rc-d-command](https://unix.stackexchange.com/questions/102918/service-to-start-on-boot-doesnt-work-with-update-rc-d-command)"
}